library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.std_logic_unsigned.all;


entity bcd_counter is
	port(
		Clk, Init, Enable, Direction : in std_logic;
		Q : out std_logic_vector(3 downto 0)
	);
end entity bcd_counter;


architecture abcd_counter of bcd_counter is
begin
	process (Clk, Init, Enable)
		variable vQ : std_logic_vector(3 downto 0) := "0000";
	begin
		if (Enable = '1') then
			if (Init = '1') then
				if (Direction = '0') then
					vQ := "0000";
				else
					vQ := "1001";
				end if;
				Q <= vQ;
			elsif (Clk'event and Clk = '1') then
				if (Direction = '0') then
					if (vQ /= "1001") then
						vQ := vQ + "0001";
					else
						vQ := "0000";
					end if;
				else
					if (vQ /= "0000") then
						vQ := vQ - "0001";
					else
						vQ := "1001";
					end if;
				end if;
				Q <= vQ;
			end if;
		end if;
	end process;

end architecture abcd_countera;